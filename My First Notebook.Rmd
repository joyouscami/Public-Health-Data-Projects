---
title: "My First Portfolio Project!"
output: html_notebook
editor_options: 
  markdown: 
    wrap: 72
---

Introduction

Hello, my name is Joy. For the past 3 months I have been self learning
how to analyze data and build models using the R programming language.My
resources have been The Book of R, a first course in programming and
statistics by Tilman M. Davies, Youtube and swirl(), a package that
allows you to learn R within R. To test my understanding, I'm now
building my first portfolio project using R and a dataset I got from
Kaggle.

About the Data

Data has been collected from different hospitals, community clinics,
maternal health cares through the IoT based risk monitoring system. •
Age: Age in years when a woman is pregnant. • SystolicBP: Upper value of
Blood Pressure in mmHg, another significant attribute during pregnancy.
• DiastolicBP: Lower value of Blood Pressure in mmHg, another
significant attribute during pregnancy. • BS: Blood glucose levels is in
terms of a molar concentration, mmol/L. • HeartRate: A normal resting
heart rate in beats per minute. • Risk Level: Predicted Risk Intensity
Level during pregnancy considering the previous attribute.

Which health conditions are the strongest indications for health risks
during pregnancy?

Loading the data

```{r}
#Loading the necessary Libraries
options(prompt="R>")
library(readr)
library(dplyr)
library(ggplot2)
library(caret)
#Loading the data
setwd("C:/R Programming")
data<-read.csv("C:/R Programming/Maternal Health Risk.csv")
#Chaecking the structure of the data
str(data)
```

Data Pre-processing. - check for missing values - Handle any missing
data if present

```{r}
#Checking for missing values
sum(is.na(data))
```

Exploratory Data Analysis - Since there are no missing values, we
proceed with data exploration - Visualizing the data to understand the
distributions and relationships

```{r}
#Data exploration
summary(data)
#histograms for each attribute
ggplot(data,aes(x=Age))+geom_histogram(binwidth=2)+ggtitle("Age Distribution")
ggplot(data,aes(x=SystolicBP))+geom_histogram(binwidth=5)+
  ggtitle("Systolic BP Distribution")
ggplot(data,aes(x=DiastolicBP))+geom_histogram(binwidth=5)+
  ggtitle("Diastolic BP Distribution")
ggplot(data,aes(x=BS))+geom_histogram(binwidth=0.5)+
  ggtitle("Blood Glucose Levels Distribution",subtitle= "Blood sugar levels")
ggplot(data,aes(x=HeartRate))+geom_histogram(binwidth=5)+
  ggtitle("Heart Rate Distribution", subtitle = "How is your heart beating?")
```

Correlation Analysis - We'll perform correlation Analysis to measure the
strength and direction of the relationships between the individual
variables - Correlation analysis identifies which variables are linearly
related and helps in understanding the interdependencies among
variables. This can indicate which variables might be predictive of risk
levels

```{r}
#correlation matrix
cor_matrix<-cor(data %>%select(-RiskLevel))
print(cor_matrix)
#Visualizing the relationships
library(corrplot)
corrplot(cor_matrix,method="circle")
```

Assessing risk levels across age groups

```{r}
#Assessing risk level across age groups
age_breaks<-c(0,20,30,40,50,100)
age_labels<-c("0-20","21-30","31-40","41-50","51+")
data$AgeGroup<-cut(data$Age,breaks=age_breaks,labels=age_labels,right=FALSE)
risk_age_table<-table(data$AgeGroup,data$RiskLevel)
print(risk_age_table)
risk_age_prop<-prop.table(risk_age_table,margin=1)
print(risk_age_prop)
#visualizing the results
ggplot(data,aes(x=AgeGroup,fill=RiskLevel))+geom_bar(position="Fill")+
  labs(title="Distribution of Risk Levels aross Age Groups",
       X="AgeGroup",y="proportion")+theme_minimal()
```

Multinomial Logistic Regression - we'll create a multinomial logistic
regression model to assess how various attributes relate to the Risk
Level - I used the relevel function to explicitely set the reference
category to 'mid risk' and 'low risk' before running the model in the
two consecutive times

```{r}
#multinomial logistic regression 
library(nnet)
data$RiskLevel<-as.factor(data$RiskLevel)
model_multinom <- multinom(RiskLevel ~ Age + SystolicBP + DiastolicBP + BS + 
                             HeartRate,data=data)
summary(model_multinom)
#Risk Frequencies
risk_frequencies<-table(data$RiskLevel)
print(risk_frequencies)
barplot(risk_frequencies,main="Frequencies of Risk Levels",xlab="Risk Level",
        ylab="Frequency",col="blue")
data$RiskLevel<-relevel(data$RiskLevel,ref="low risk") 
#Using Relevel to explicitely set different reference categories
model_multinom <- multinom(RiskLevel ~ Age + SystolicBP + DiastolicBP + BS +
                             HeartRate,data=data)
summary(model_multinom)
data$RiskLevel<-relevel(data$RiskLevel,ref="mid risk")
model_multinom <- multinom(RiskLevel ~ Age + SystolicBP + DiastolicBP + BS + 
                             HeartRate,data=data)
summary(model_multinom)
```
